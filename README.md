# Проектная работа "Веб-ларек"

![yandex_practicum](./src/images/imagecopy.png)

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Архитектура
**MVP (Model-View-Presenter)** 
- Model - отвечает за данные и бизнес логику.
- View - отвечает за отображение данных и взаимодействие с пользователем.
- Presenter - посредник между логикой и интерфейсом, он получает события от Представления, обновляет Модель, получает данные от Модели и передает их Представлению для отображения.


## Описание базовых классов
Класс `EventEmitter` обеспечивает работу с событиями. Его функции: возможность подписываться на события, отписываться от них и генерировать события для оповещения других частей приложения.

Класс `Api` отвечает за взаимодействие с сервером. Он предоставляет методы для отправки запросов на получение и отправку данных.

## Компоненты
**Компонент: Каталог товаров (Gallery)**
* **Назначение и функции**: Отображает список всех доступных товаров в виде сетки или списка. Он является контейнером для отдельных карточек товаров.
* **Взаимодействие с другими компонентами**:
* Содержит и отображает **Карточки товаров**.
* Может взаимодействовать с **Моделью Товара** для получения актуальных данных о товарах.
* Через EventEmitter может сигнализировать о событиях, связанных с фильтрацией или сортировкой (если такая функциональность будет добавлена позже).
* **Данные**: Получает массив объектов Product (или массив данных, из которых можно создать Product модели).

**Компонент: Карточка товара (Card)**
* **Назначение и функции**: Отображает краткую информацию об одном товаре (название, категория, цена, изображение, возможно, краткое описание) и предоставляет точки взаимодействия для пользователя.
* **Данные**: Принимает объект Product (или его часть) для отображения.
* **Взаимодействие с другими компонентами/моделями**:
* При клике на саму карточку: Генерирует событие (например, 'card:select' или 'card:openPreview'), содержащее id товара, чтобы **Модальное окно просмотра товара** могло открыться с детальной информацией.
* При клике на кнопку "Купить" (если она есть на самой карточке или в ее подробном представлении): Генерирует событие (например, 'card:buy' или 'card:addToBasket'), содержащее id товара, чтобы **Модель Корзины** могла добавить товар, а **Иконка корзины в шапке** и сама **Карточка** могли обновить свое состояние.
* **События**: Генерирует события, такие как card:select (для открытия модального окна просмотра) и card:buy (для добавления товара в корзину).

**Компонент: Иконка корзины в шапке (Header Basket Icon)**
* **Назначение и функции**: Отображает текущее количество товаров в корзине. Служит точкой входа для открытия модального окна корзины.
* **Данные**: Принимает число — общее количество товаров в корзине (получает от **Модели Корзины**).
* **Взаимодействие с другими компонентами/моделями**:
* При клике: Генерирует событие (например, 'basketIcon:open'), которое сообщает **Модальному окну Корзины и оформления заказа** о необходимости открыться.
* Получает обновления от **Модели Корзины** при добавлении или удалении товаров, чтобы обновить отображаемый счетчик.
* **События**: Генерирует событие basketIcon:open.

**Компонент: Модальное окно просмотра товара (Product Preview Modal)**
* **Назначение и функции**: Отображает полную детальную информацию об одном выбранном товаре (включая название, полное описание, категорию, цену, изображение) и предоставляет кнопку "Купить" или "Удалить из корзины" в зависимости от текущего статуса товара. Также обрабатывает закрытие модального окна.
* **Данные**: Принимает полный объект Product (включая id, isInCart и все остальные свойства) для отображения.
* **Взаимодействие с другими компонентами/моделями**:
* **Открытие**: Открывается в ответ на событие (например, 'card:select'), генерируемое **Карточкой товара**.
* **Кнопка "Купить"/"Удалить"**: При нажатии:
* Генерирует событие (например, 'productPreview:addToBasket' или 'productPreview:removeFromBasket'), содержащее id товара.
* Это событие обрабатывается **Моделью Корзины**, которая добавляет/удаляет товар.
* После изменения в корзине, **Модель Корзины** генерирует событие об изменении, которое может быть использовано для обновления состояния кнопки "Купить/Удалить" в этом модальном окне, а также на **Карточке товара** и **Иконке корзины в шапке**.
* **Закрытие**:
* Закрывается по клику на иконку "Закрыть" (крестик).
* Закрывается по клику вне области модального окна.
* **События**:
* Генерирует событие productPreview:addToBasket (для добавления в корзину).
* Генерирует событие productPreview:removeFromBasket (для удаления из корзины).
* Генерирует событие modal:close или подобное при закрытии.

**Компонент: Модальное окно Корзины и оформления заказа (Basket & Order Modal)**
* **Назначение и функции**: Управляет всем процессом оформления заказа, от просмотра товаров в корзине до подтверждения покупки. Отображает содержимое корзины, собирает информацию для доставки и оплаты, обрабатывает валидацию форм и показывает сообщение об успешном завершении.
* **Составные части / Шаги:**

**Просмотр Корзины:**
* **Функция**: Отображает список товаров, добавленных в корзину, их количество и общую стоимость. Позволяет пользователю удалить товар из корзины.
* **Данные**: Получает массив объектов Product из **Модели Корзины** (или только те, которые находятся в корзине), а также общую стоимость.
* **Взаимодействие**:
* Кнопка "Удалить": Генерирует событие (например, 'basket:removeItem'), содержащее id товара, для удаления из **Модели Корзины**.
* Кнопка "Оформить" (или "Далее"): Генерирует событие (например, 'basket:checkout') для перехода к первому шагу оформления заказа.

**Шаг 1: Выбор оплаты и адрес доставки:**
* **Функция**: Предлагает пользователю выбрать способ оплаты (например, онлайн или при получении) и ввести адрес доставки. Валидирует введенные данные.
* **Данные**: Принимает/отправляет данные о способе оплаты и адресе доставки.
* **Взаимодействие**:
* Поля ввода/выбора: Отслеживает изменения в полях, применяет валидацию.
* Кнопка "Далее": Активируется только при валидных данных (выбран способ оплаты, адрес не пуст). При нажатии генерирует событие (например, 'order:addressSubmitted'), передавая введенные данные и переходя к следующему шагу.
* Отображает сообщения об ошибках валидации.

**Шаг 2: Ввод контактных данных (Email и Телефон):**
* **Функция**: Собирает Email и номер телефона пользователя. Валидирует введенные данные.
* **Данные**: Принимает/отправляет Email и телефон.
* **Взаимодействие**:
* Поля ввода: Отслеживает изменения, применяет валидацию (поля не должны быть пустыми).
* Кнопка "Оплатить": Активируется только при валидных данных. При нажатии генерирует событие (например, 'order:confirm'), передавая все собранные данные заказа в **Модель Заказа** и/или напрямую в **Клиент API**.
* Отображает сообщения об ошибках валидации.

**Сообщение об успешной покупке (Order Success):**
* **Функция**: Отображает подтверждение успешного оформления заказа, сумму списанных средств. Предоставляет кнопку для закрытия модального окна.

* **Данные**: Принимает итоговую сумму заказа.

* **Взаимодействие**:
* Кнопка "За новыми покупками!": При нажатии генерирует событие (например, 'orderSuccess:close') для закрытия модального окна и, возможно, сброса состояния корзины и других форм.

* **Общие взаимодействия и закрытие:**
* **Открытие**: Открывается в ответ на событие (например, 'basketIcon:open'), генерируемое **Иконкой корзины в шапке**.

* **Закрытие**: Закрывается:
* По клику на иконку "Закрыть" (крестик).
* По клику вне области модального окна.
* Генерирует событие modal:close или подобное при любом из способов закрытия.

* **Взаимодействие с Моделями**: Получает данные от **Модели Корзины** и отправляет данные в **Модель Заказа** (или напрямую через **Клиент API**).

* **Валидация**: Содержит внутреннюю логику валидации для своих форм.

* **События**:
* basket:removeItem (удаление товара из корзины)
* basket:checkout (переход к первому шагу заказа)
* order:addressSubmitted (заполнение данных адреса и оплаты)
* order:confirm (подтверждение заказа)
* orderSuccess:close (закрытие окна успеха)
* modal:close (общее событие закрытия модального окна)
